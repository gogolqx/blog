---
layout: post
title: 正则表达式
categories: Other
---

正则表达式是通过元字符与一般字符的某个组合，匹配多个符合其描述的字符串的检索方式。归根究底，它不过是一种字符串处理的强大工具。由于其规则不受限于特定的编程语言，因此不存在跨语言的学习成本。

<!-- more -->

来看一些例子：

| 表达式 | a.c | a[bc]d | a\dd | abc* |
| 可匹配值1 | abc | abd | a1d | ab |
| 可匹配值2 | adc | acd | a9d | abcc |

## 元字符

一些特殊的字符在正则表达式中并不仅仅匹配其本身，而有更丰富的含义。它们称为“元字符”。

- **句点 .**：匹配除换行符（\n）外的所有字符。
- **尖角符 ^**：匹配字符串开头，或多行下每一行开头。不占位。
- **美元符 \$**：匹配字符串结尾，或多行下每一行结尾。不占位。
- **星号 \***：匹配前一个字符 0 到无限次。
- **加号 +**：匹配前一个字符 1 到无限次。
- **问号 ?**：匹配前一个字符 0 或 1 次。
- **花括号 {}**：用 {m} 表示匹配前一个字符恰好 m 次；用 {m,n} 表示匹配前一个字符 m 到 n 次。如果 m 留空，缺省值 0；如果 n 留空，缺省值 $\infty$。
- **方括号 []**：字符集。对应单个字符位，匹配字符集内的元素。字符集内部的语法：  
      - 并列：比如 [Aa] 表示该字符位可以匹配大写A或者小写a。  
      - 起止：比如 [a-c] 补充该字符位可以匹配小写a/b/c。  
      - 取反：比如 [^a] 表示该字符位可以匹配除了小写a外的所有字符。  
      - 组合：比如 [0-9A-Z] 表示匹配大写字母或数字。  
- **圆括号 ()**：分组符号。每检测到一个左圆括号，该分组都会被依次序编号，从 1 开始。
- **反斜杠 \\**：转义使元字符本身被匹配。比如 \? 匹配一个西文问号。
- **竖线符 \|**：逻辑或。左侧与右侧的表达式任意匹配一个，如果左侧匹配则不检验右侧。通过圆括号限定两端表达式的起止。

## 预定义字符集

对于方括号内包裹的内容，我们称之为字符集。预定义的字符集有：

- **数字集 \\d**：匹配单个数字。大写 \\D 则匹配单个非数字。
- **单词集 \\w**：匹配单个数字或大写字母或小写字母。大写 \\W 则取反。
- **空白集 \\s**：匹配单个空白符（空格、制表符 \\t、回车符 \\r、换行符 \\n、换页符 \\f、垂直制表符 \\v）。大写 \\S 取反。

## 数量限定

对于单个的字符，数量限定直接加在其右侧即可；对于多字符表达式，请将其放在圆括号内，再在其右侧添加数量限定。如同元字符中提到的，数量限定主要方式有：

- \*/+/?
- {m}/{m,n}

## 引用

引用主要有两种：

1. 通过分组本身的编号可以引用，例如：`(\d)ab\1` 可以匹配 1ab1，或者 2ab2.  
2.  通过别名进行引用。上例可写为：`(?\P<id>\d)ab(?P=id)`，效果一致。

通过 `(?:)` 实现非捕获组，不参与编号。比如 `(?:abc)`.

## 前向/后向断言

断言中虽然有分组符号，但是编号时会忽略它们。断言不占位。

- **后向断言**：后向肯定断言 `(?=)`，比如 `a(?=\d)` 匹配后跟数字的字母a；后向否定断言 `(?!)`，比如 `a(?!\d)` 匹配后跟非数字的字母a。
- **前向断言**：用法类似，只不过加上 `<` 号并放在表达式左侧。比如 `(?<=\d)a` 表示匹配跟在数字后的字母a；同理 `(?<!\d)a`。

## 其他

如果编号 id / 别名 name 的组成功匹配了，那么此处匹配 yes-pattern；否则此处匹配 no-pattern：

        (?(id/name)yes-pattern|no-pattern)

最后提醒一点：**{m,n} 中的逗号后不能有空格！**
